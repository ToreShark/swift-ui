# Используем официальный образ Node.js последней версии
FROM node:latest

# Создаем директорию приложения
WORKDIR /usr/src/app

# Копируем файлы проекта
COPY . .

# Устанавливаем зависимости, включая PM2 глобально
RUN npm install && npm install pm2 -g

# Собираем проект, если это необходимо (зависит от проекта)
RUN npm run build

# Открываем порт, который использует приложение
EXPOSE 3000

# Запускаем приложение с помощью PM2
CMD ["pm2-runtime", "start", "dist/main.js"]